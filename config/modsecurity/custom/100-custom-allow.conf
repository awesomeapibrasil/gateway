# Custom Allow Rules
# Rules that explicitly allow certain traffic patterns

# Allow health check endpoints
SecRule REQUEST_URI "@beginsWith /health" "id:100001,msg:'Health check endpoint',severity:NOTICE,phase:1,allow"
SecRule REQUEST_URI "@beginsWith /metrics" "id:100002,msg:'Metrics endpoint',severity:NOTICE,phase:1,allow"
SecRule REQUEST_URI "@beginsWith /status" "id:100003,msg:'Status endpoint',severity:NOTICE,phase:1,allow"

# Allow specific trusted user agents
SecRule REQUEST_HEADERS:User-Agent "@contains GoogleBot" "id:100011,msg:'Google Bot allowed',severity:NOTICE,phase:1,allow"
SecRule REQUEST_HEADERS:User-Agent "@contains BingBot" "id:100012,msg:'Bing Bot allowed',severity:NOTICE,phase:1,allow"

# Allow trusted IP ranges (internal networks)
# Note: This would be better handled via IP whitelist configuration
# SecRule REMOTE_ADDR "@beginsWith 10." "id:100021,msg:'Internal network allowed',severity:NOTICE,phase:1,allow"
# SecRule REMOTE_ADDR "@beginsWith 192.168." "id:100022,msg:'Private network allowed',severity:NOTICE,phase:1,allow"

# Allow specific API endpoints with relaxed rules
SecRule REQUEST_URI "@beginsWith /api/v1/public" "id:100031,msg:'Public API endpoint',severity:NOTICE,phase:1,allow"